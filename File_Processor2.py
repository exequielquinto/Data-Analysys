import pandas as pd

filename='Orig Trf Opt A No Fan from 70% no mag enc retest'

sample_data=pd.read_csv(filename+'.csv')
data = pd.DataFrame()
data_ave = pd.DataFrame()  

#print sample_data.shape[0]
max_col = sample_data.shape[0]-1
#print max_col

cntr=0
while cntr<max_col:
    #if (sample_data.D_Watts_AC.iloc[cntr]-sample_data.D_Watts_AC.iloc[cntr+1])<70:   #Negative value for Charging
    if (sample_data['1004_PA4000 0101 Ch1 Watts StdResults '].iloc[cntr]-sample_data['1004_PA4000 0101 Ch1 Watts StdResults '].iloc[cntr+1])<35:  #Discharging
    #if (-sample_data['1004_PA4000 0101 Ch1 Watts StdResults '].iloc[cntr]-(-sample_data['1004_PA4000 0101 Ch1 Watts StdResults '].iloc[cntr+1]))<20:   #Charging
        #print (sample_data.D_Watts_AC.iloc[cntr+1]-sample_data.D_Watts_AC.iloc[cntr])
        cntr=cntr+1
        #print sample_data.Watts_AC.iloc[cntr]
        #print ('run')
        #print cntr
    else:
        #print (cntr+2)
        #print sample_data.Watts_AC.iloc[cntr]
        #print (sample_data.Watts_AC.iloc[cntr]-sample_data.Watts_AC.iloc[cntr+1])
        cntr=cntr+1
        #temp=sample_data[["A_Taken","B_Vrms","C_Arms","D_Watts_AC","E_PF","F_Freq","G_Athd","H_Watts_DC","I_Vdc","J_Adc","K_Eff"]].iloc[(cntr-11):(cntr-1)]
        temp=sample_data[['1002_PA4000 0101 Ch1 Vrms StdResults ','1003_PA4000 0101 Ch1 Arms StdResults ','1004_PA4000 0101 Ch1 Watts StdResults ','1005_PA4000 0101 Ch1 PF StdResults ','1006_PA4000 0101 Ch1 Freq StdResults ','1008_PA4000 0101 Ch1 Athd StdResults ','1089_PA4000 0101 Ch1 Magnitude H1 AmpHarms ','1091_PA4000 0101 Ch1 Magnitude H2 AmpHarms ','1093_PA4000 0101 Ch1 Magnitude H3 AmpHarms ','1095_PA4000 0101 Ch1 Magnitude H4 AmpHarms ','1097_PA4000 0101 Ch1 Magnitude H5 AmpHarms ','1099_PA4000 0101 Ch1 Magnitude H6 AmpHarms ','1101_PA4000 0101 Ch1 Magnitude H7 AmpHarms ','1103_PA4000 0101 Ch1 Magnitude H8 AmpHarms ','1105_PA4000 0101 Ch1 Magnitude H9 AmpHarms ','1107_PA4000 0101 Ch1 Magnitude H10 AmpHarms ','1109_PA4000 0101 Ch1 Magnitude H11 AmpHarms ','1111_PA4000 0101 Ch1 Magnitude H12 AmpHarms ','1113_PA4000 0101 Ch1 Magnitude H13 AmpHarms ','1115_PA4000 0101 Ch1 Magnitude H14 AmpHarms ','1117_PA4000 0101 Ch1 Magnitude H15 AmpHarms ','1119_PA4000 0101 Ch1 Magnitude H16 AmpHarms ','1121_PA4000 0101 Ch1 Magnitude H17 AmpHarms ','1123_PA4000 0101 Ch1 Magnitude H18 AmpHarms ','1125_PA4000 0101 Ch1 Magnitude H19 AmpHarms ','1127_PA4000 0101 Ch1 Magnitude H20 AmpHarms ','1129_PA4000 0101 Ch1 Magnitude H21 AmpHarms ','1131_PA4000 0101 Ch1 Magnitude H22 AmpHarms ','1133_PA4000 0101 Ch1 Magnitude H23 AmpHarms ','1135_PA4000 0101 Ch1 Magnitude H24 AmpHarms ','1137_PA4000 0101 Ch1 Magnitude H25 AmpHarms ','1139_PA4000 0101 Ch1 Magnitude H26 AmpHarms ','1141_PA4000 0101 Ch1 Magnitude H27 AmpHarms ','1143_PA4000 0101 Ch1 Magnitude H28 AmpHarms ','1145_PA4000 0101 Ch1 Magnitude H29 AmpHarms ','1147_PA4000 0101 Ch1 Magnitude H30 AmpHarms ','1149_PA4000 0101 Ch1 Magnitude H31 AmpHarms ','1151_PA4000 0101 Ch1 Magnitude H32 AmpHarms ','1153_PA4000 0101 Ch1 Magnitude H33 AmpHarms ','1155_PA4000 0101 Ch1 Magnitude H34 AmpHarms ','1157_PA4000 0101 Ch1 Magnitude H35 AmpHarms ','1159_PA4000 0101 Ch1 Magnitude H36 AmpHarms ','1161_PA4000 0101 Ch1 Magnitude H37 AmpHarms ','1163_PA4000 0101 Ch1 Magnitude H38 AmpHarms ','1165_PA4000 0101 Ch1 Magnitude H39 AmpHarms ','1167_PA4000 0101 Ch1 Magnitude H40 AmpHarms ','1169_PA4000 0101 Ch2 Vrms StdResults ','1170_PA4000 0101 Ch2 Arms StdResults ','1171_PA4000 0101 Ch2 Watts StdResults ','1172_PA4000 0101 Ch2 Vdc StdResults ','1173_PA4000 0101 Ch2 Adc StdResults ']].iloc[(cntr-11):(cntr-1)]
        #temp=sample_data.iloc[(cntr-11):(cntr-1)]
        #print temp.mean(axis=0)
        data=data.append(temp, ignore_index=True)
        data_ave=data_ave.append(temp.mean(axis=0), ignore_index=True)
        
#temp=sample_data[["A_Taken","B_Vrms","C_Arms","D_Watts_AC","E_PF","F_Freq","G_Athd","H_Watts_DC","I_Vdc","J_Adc","K_Eff"]].iloc[(max_col-10):(max_col)]
temp=sample_data[['1002_PA4000 0101 Ch1 Vrms StdResults ','1003_PA4000 0101 Ch1 Arms StdResults ','1004_PA4000 0101 Ch1 Watts StdResults ','1005_PA4000 0101 Ch1 PF StdResults ','1006_PA4000 0101 Ch1 Freq StdResults ','1008_PA4000 0101 Ch1 Athd StdResults ','1089_PA4000 0101 Ch1 Magnitude H1 AmpHarms ','1091_PA4000 0101 Ch1 Magnitude H2 AmpHarms ','1093_PA4000 0101 Ch1 Magnitude H3 AmpHarms ','1095_PA4000 0101 Ch1 Magnitude H4 AmpHarms ','1097_PA4000 0101 Ch1 Magnitude H5 AmpHarms ','1099_PA4000 0101 Ch1 Magnitude H6 AmpHarms ','1101_PA4000 0101 Ch1 Magnitude H7 AmpHarms ','1103_PA4000 0101 Ch1 Magnitude H8 AmpHarms ','1105_PA4000 0101 Ch1 Magnitude H9 AmpHarms ','1107_PA4000 0101 Ch1 Magnitude H10 AmpHarms ','1109_PA4000 0101 Ch1 Magnitude H11 AmpHarms ','1111_PA4000 0101 Ch1 Magnitude H12 AmpHarms ','1113_PA4000 0101 Ch1 Magnitude H13 AmpHarms ','1115_PA4000 0101 Ch1 Magnitude H14 AmpHarms ','1117_PA4000 0101 Ch1 Magnitude H15 AmpHarms ','1119_PA4000 0101 Ch1 Magnitude H16 AmpHarms ','1121_PA4000 0101 Ch1 Magnitude H17 AmpHarms ','1123_PA4000 0101 Ch1 Magnitude H18 AmpHarms ','1125_PA4000 0101 Ch1 Magnitude H19 AmpHarms ','1127_PA4000 0101 Ch1 Magnitude H20 AmpHarms ','1129_PA4000 0101 Ch1 Magnitude H21 AmpHarms ','1131_PA4000 0101 Ch1 Magnitude H22 AmpHarms ','1133_PA4000 0101 Ch1 Magnitude H23 AmpHarms ','1135_PA4000 0101 Ch1 Magnitude H24 AmpHarms ','1137_PA4000 0101 Ch1 Magnitude H25 AmpHarms ','1139_PA4000 0101 Ch1 Magnitude H26 AmpHarms ','1141_PA4000 0101 Ch1 Magnitude H27 AmpHarms ','1143_PA4000 0101 Ch1 Magnitude H28 AmpHarms ','1145_PA4000 0101 Ch1 Magnitude H29 AmpHarms ','1147_PA4000 0101 Ch1 Magnitude H30 AmpHarms ','1149_PA4000 0101 Ch1 Magnitude H31 AmpHarms ','1151_PA4000 0101 Ch1 Magnitude H32 AmpHarms ','1153_PA4000 0101 Ch1 Magnitude H33 AmpHarms ','1155_PA4000 0101 Ch1 Magnitude H34 AmpHarms ','1157_PA4000 0101 Ch1 Magnitude H35 AmpHarms ','1159_PA4000 0101 Ch1 Magnitude H36 AmpHarms ','1161_PA4000 0101 Ch1 Magnitude H37 AmpHarms ','1163_PA4000 0101 Ch1 Magnitude H38 AmpHarms ','1165_PA4000 0101 Ch1 Magnitude H39 AmpHarms ','1167_PA4000 0101 Ch1 Magnitude H40 AmpHarms ','1169_PA4000 0101 Ch2 Vrms StdResults ','1170_PA4000 0101 Ch2 Arms StdResults ','1171_PA4000 0101 Ch2 Watts StdResults ','1172_PA4000 0101 Ch2 Vdc StdResults ','1173_PA4000 0101 Ch2 Adc StdResults ']].iloc[(max_col-10):(max_col)]
#temp=sample_data.iloc[(max_col-10):(max_col)]
data=data.append(temp, ignore_index=True)
data_ave=data_ave.append(temp.mean(axis=0), ignore_index=True)
#data.to_csv(filename+'_Processed'+'.csv')

cntr=0
while cntr<max_col:
    if (-sample_data['1004_PA4000 0101 Ch1 Watts StdResults '].iloc[cntr]-(-sample_data['1004_PA4000 0101 Ch1 Watts StdResults '].iloc[cntr+1]))<20:   #Charging
        cntr=cntr+1
    else:
        cntr=cntr+1
        temp=sample_data[['1002_PA4000 0101 Ch1 Vrms StdResults ','1003_PA4000 0101 Ch1 Arms StdResults ','1004_PA4000 0101 Ch1 Watts StdResults ','1005_PA4000 0101 Ch1 PF StdResults ','1006_PA4000 0101 Ch1 Freq StdResults ','1008_PA4000 0101 Ch1 Athd StdResults ','1089_PA4000 0101 Ch1 Magnitude H1 AmpHarms ','1091_PA4000 0101 Ch1 Magnitude H2 AmpHarms ','1093_PA4000 0101 Ch1 Magnitude H3 AmpHarms ','1095_PA4000 0101 Ch1 Magnitude H4 AmpHarms ','1097_PA4000 0101 Ch1 Magnitude H5 AmpHarms ','1099_PA4000 0101 Ch1 Magnitude H6 AmpHarms ','1101_PA4000 0101 Ch1 Magnitude H7 AmpHarms ','1103_PA4000 0101 Ch1 Magnitude H8 AmpHarms ','1105_PA4000 0101 Ch1 Magnitude H9 AmpHarms ','1107_PA4000 0101 Ch1 Magnitude H10 AmpHarms ','1109_PA4000 0101 Ch1 Magnitude H11 AmpHarms ','1111_PA4000 0101 Ch1 Magnitude H12 AmpHarms ','1113_PA4000 0101 Ch1 Magnitude H13 AmpHarms ','1115_PA4000 0101 Ch1 Magnitude H14 AmpHarms ','1117_PA4000 0101 Ch1 Magnitude H15 AmpHarms ','1119_PA4000 0101 Ch1 Magnitude H16 AmpHarms ','1121_PA4000 0101 Ch1 Magnitude H17 AmpHarms ','1123_PA4000 0101 Ch1 Magnitude H18 AmpHarms ','1125_PA4000 0101 Ch1 Magnitude H19 AmpHarms ','1127_PA4000 0101 Ch1 Magnitude H20 AmpHarms ','1129_PA4000 0101 Ch1 Magnitude H21 AmpHarms ','1131_PA4000 0101 Ch1 Magnitude H22 AmpHarms ','1133_PA4000 0101 Ch1 Magnitude H23 AmpHarms ','1135_PA4000 0101 Ch1 Magnitude H24 AmpHarms ','1137_PA4000 0101 Ch1 Magnitude H25 AmpHarms ','1139_PA4000 0101 Ch1 Magnitude H26 AmpHarms ','1141_PA4000 0101 Ch1 Magnitude H27 AmpHarms ','1143_PA4000 0101 Ch1 Magnitude H28 AmpHarms ','1145_PA4000 0101 Ch1 Magnitude H29 AmpHarms ','1147_PA4000 0101 Ch1 Magnitude H30 AmpHarms ','1149_PA4000 0101 Ch1 Magnitude H31 AmpHarms ','1151_PA4000 0101 Ch1 Magnitude H32 AmpHarms ','1153_PA4000 0101 Ch1 Magnitude H33 AmpHarms ','1155_PA4000 0101 Ch1 Magnitude H34 AmpHarms ','1157_PA4000 0101 Ch1 Magnitude H35 AmpHarms ','1159_PA4000 0101 Ch1 Magnitude H36 AmpHarms ','1161_PA4000 0101 Ch1 Magnitude H37 AmpHarms ','1163_PA4000 0101 Ch1 Magnitude H38 AmpHarms ','1165_PA4000 0101 Ch1 Magnitude H39 AmpHarms ','1167_PA4000 0101 Ch1 Magnitude H40 AmpHarms ','1169_PA4000 0101 Ch2 Vrms StdResults ','1170_PA4000 0101 Ch2 Arms StdResults ','1171_PA4000 0101 Ch2 Watts StdResults ','1172_PA4000 0101 Ch2 Vdc StdResults ','1173_PA4000 0101 Ch2 Adc StdResults ']].iloc[(cntr-11):(cntr-1)]
        data=data.append(temp, ignore_index=True)
        data_ave=data_ave.append(temp.mean(axis=0), ignore_index=True)
        
temp=sample_data[['1002_PA4000 0101 Ch1 Vrms StdResults ','1003_PA4000 0101 Ch1 Arms StdResults ','1004_PA4000 0101 Ch1 Watts StdResults ','1005_PA4000 0101 Ch1 PF StdResults ','1006_PA4000 0101 Ch1 Freq StdResults ','1008_PA4000 0101 Ch1 Athd StdResults ','1089_PA4000 0101 Ch1 Magnitude H1 AmpHarms ','1091_PA4000 0101 Ch1 Magnitude H2 AmpHarms ','1093_PA4000 0101 Ch1 Magnitude H3 AmpHarms ','1095_PA4000 0101 Ch1 Magnitude H4 AmpHarms ','1097_PA4000 0101 Ch1 Magnitude H5 AmpHarms ','1099_PA4000 0101 Ch1 Magnitude H6 AmpHarms ','1101_PA4000 0101 Ch1 Magnitude H7 AmpHarms ','1103_PA4000 0101 Ch1 Magnitude H8 AmpHarms ','1105_PA4000 0101 Ch1 Magnitude H9 AmpHarms ','1107_PA4000 0101 Ch1 Magnitude H10 AmpHarms ','1109_PA4000 0101 Ch1 Magnitude H11 AmpHarms ','1111_PA4000 0101 Ch1 Magnitude H12 AmpHarms ','1113_PA4000 0101 Ch1 Magnitude H13 AmpHarms ','1115_PA4000 0101 Ch1 Magnitude H14 AmpHarms ','1117_PA4000 0101 Ch1 Magnitude H15 AmpHarms ','1119_PA4000 0101 Ch1 Magnitude H16 AmpHarms ','1121_PA4000 0101 Ch1 Magnitude H17 AmpHarms ','1123_PA4000 0101 Ch1 Magnitude H18 AmpHarms ','1125_PA4000 0101 Ch1 Magnitude H19 AmpHarms ','1127_PA4000 0101 Ch1 Magnitude H20 AmpHarms ','1129_PA4000 0101 Ch1 Magnitude H21 AmpHarms ','1131_PA4000 0101 Ch1 Magnitude H22 AmpHarms ','1133_PA4000 0101 Ch1 Magnitude H23 AmpHarms ','1135_PA4000 0101 Ch1 Magnitude H24 AmpHarms ','1137_PA4000 0101 Ch1 Magnitude H25 AmpHarms ','1139_PA4000 0101 Ch1 Magnitude H26 AmpHarms ','1141_PA4000 0101 Ch1 Magnitude H27 AmpHarms ','1143_PA4000 0101 Ch1 Magnitude H28 AmpHarms ','1145_PA4000 0101 Ch1 Magnitude H29 AmpHarms ','1147_PA4000 0101 Ch1 Magnitude H30 AmpHarms ','1149_PA4000 0101 Ch1 Magnitude H31 AmpHarms ','1151_PA4000 0101 Ch1 Magnitude H32 AmpHarms ','1153_PA4000 0101 Ch1 Magnitude H33 AmpHarms ','1155_PA4000 0101 Ch1 Magnitude H34 AmpHarms ','1157_PA4000 0101 Ch1 Magnitude H35 AmpHarms ','1159_PA4000 0101 Ch1 Magnitude H36 AmpHarms ','1161_PA4000 0101 Ch1 Magnitude H37 AmpHarms ','1163_PA4000 0101 Ch1 Magnitude H38 AmpHarms ','1165_PA4000 0101 Ch1 Magnitude H39 AmpHarms ','1167_PA4000 0101 Ch1 Magnitude H40 AmpHarms ','1169_PA4000 0101 Ch2 Vrms StdResults ','1170_PA4000 0101 Ch2 Arms StdResults ','1171_PA4000 0101 Ch2 Watts StdResults ','1172_PA4000 0101 Ch2 Vdc StdResults ','1173_PA4000 0101 Ch2 Adc StdResults ']].iloc[(max_col-10):(max_col)]
data=data.append(temp, ignore_index=True)
data_ave=data_ave.append(temp.mean(axis=0), ignore_index=True)

data_ave.to_csv(filename+'_Processed_Averaged'+'.csv')
#data.to_csv(filename+'_Processed'+'.csv')
print ('done')